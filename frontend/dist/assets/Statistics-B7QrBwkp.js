import{_ as T}from"./_plugin-vue_export-helper-BwE83l92.js";/* empty css               *//* empty css               *//* empty css                  *//* empty css                     *//* empty css                             *//* empty css                 */import{p as E}from"./papers-CVFD9aL8.js";import{g as w,i as x}from"./index-DfyD2RhD.js";import{r as g,a as Q,o as z,a3 as C,c as I,b as N,e as a,f as t,w as l,a2 as q,G as f,a4 as F,ad as G,ab as W,ac as X,q as $,n as H,P as J,t as y,v as D}from"./index-BxcNgWEf.js";const K={class:"statistics-container"},Z={class:"filter-section"},tt={class:"stat-card"},et={class:"stat-icon primary"},at={class:"stat-content"},st={class:"stat-number"},ot={class:"stat-card"},lt={class:"stat-icon success"},nt={class:"stat-content"},it={class:"stat-number"},rt={class:"stat-card"},dt={class:"stat-icon warning"},ct={class:"stat-content"},pt={class:"stat-number"},ut={class:"stat-card"},_t={class:"stat-icon info"},mt={class:"stat-content"},ft={class:"stat-number"},vt={class:"chart-card"},ht={class:"chart-card"},gt={class:"chart-card"},yt={__name:"Statistics",setup(bt){const b=g(!1),c=g(null),p=g(null),u=g(null),i=Q({year:new Date().getFullYear().toString(),dimension:"year",type:""}),d=Q({total:0,highQuality:0,growth:0,topRank:0}),v=async()=>{try{const s=await E.getPaperStats(i);Object.assign(d,{total:s.data.total||0,highQuality:s.data.highQuality||0,growth:s.data.growth||0,topRank:s.data.topRank||0}),O(s.data.charts||{})}catch(s){console.error("加载统计数据失败:",s),Object.assign(d,{total:125,highQuality:68,growth:23,topRank:3}),Y()}},O=s=>{C(()=>{k(s.trend||[]),R(s.partition||[]),S(s.department||[])})},k=s=>{if(!c.value)return;const e=x(c.value),n={tooltip:{trigger:"axis"},legend:{data:["论文数量","高质量论文"]},xAxis:{type:"category",data:s.map(o=>o.month)||["1月","2月","3月","4月","5月","6月"]},yAxis:{type:"value"},series:[{name:"论文数量",type:"line",data:s.map(o=>o.total)||[12,18,15,22,19,25],smooth:!0,itemStyle:{color:"#1890ff"}},{name:"高质量论文",type:"line",data:s.map(o=>o.highQuality)||[8,12,10,15,13,18],smooth:!0,itemStyle:{color:"#52c41a"}}]};e.setOption(n)},R=s=>{if(!p.value)return;const e=x(p.value),n={tooltip:{trigger:"item"},legend:{orient:"vertical",left:"left"},series:[{type:"pie",radius:"50%",data:s.length?s:[{value:35,name:"Q1区"},{value:28,name:"Q2区"},{value:22,name:"Q3区"},{value:15,name:"Q4区"}],emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]};e.setOption(n)},S=s=>{if(!u.value)return;const e=x(u.value),n={tooltip:{trigger:"axis"},legend:{data:["论文数量","高质量论文"]},xAxis:{type:"category",data:s.map(o=>o.department)||["计算机部","人工智能部","数据科学部","软件工程部"]},yAxis:{type:"value"},series:[{name:"论文数量",type:"bar",data:s.map(o=>o.total)||[45,38,32,28],itemStyle:{color:"#1890ff"}},{name:"高质量论文",type:"bar",data:s.map(o=>o.highQuality)||[25,22,18,15],itemStyle:{color:"#52c41a"}}]};e.setOption(n)},Y=()=>{C(()=>{k([]),R([]),S([])})},B=async()=>{b.value=!0;try{const s=await E.exportPapers(i),e=window.URL.createObjectURL(new Blob([s.data])),n=document.createElement("a");n.href=e,n.download=`论文统计报表_${i.year}.xlsx`,n.click(),window.URL.revokeObjectURL(e),D.success("导出成功")}catch{D.error("导出失败")}finally{b.value=!1}};return z(()=>{v(),window.addEventListener("resize",()=>{C(()=>{var s,e,n;c.value&&((s=w(c.value))==null||s.resize()),p.value&&((e=w(p.value))==null||e.resize()),u.value&&((n=w(u.value))==null||n.resize())})})}),(s,e)=>{const n=G,o=F,r=X,V=W,U=f("Download"),_=J,L=$,h=q,j=f("Document"),A=f("Star"),M=f("TrendCharts"),P=f("Medal");return N(),I("div",K,[e[11]||(e[11]=a("div",{class:"page-header"},[a("h1",{class:"page-title"},"数据统计"),a("p",{class:"page-description"},"多维度统计分析论文数据，支持可视化图表展示")],-1)),a("div",Z,[t(h,{gutter:16},{default:l(()=>[t(o,{span:6},{default:l(()=>[t(n,{modelValue:i.year,"onUpdate:modelValue":e[0]||(e[0]=m=>i.year=m),type:"year",placeholder:"选择年度",format:"YYYY","value-format":"YYYY",onChange:v},null,8,["modelValue"])]),_:1}),t(o,{span:6},{default:l(()=>[t(V,{modelValue:i.dimension,"onUpdate:modelValue":e[1]||(e[1]=m=>i.dimension=m),placeholder:"统计维度",onChange:v},{default:l(()=>[t(r,{label:"按年度统计",value:"year"}),t(r,{label:"按部门统计",value:"department"}),t(r,{label:"按个人统计",value:"person"}),t(r,{label:"按期刊分区",value:"partition"})]),_:1},8,["modelValue"])]),_:1}),t(o,{span:6},{default:l(()=>[t(V,{modelValue:i.type,"onUpdate:modelValue":e[2]||(e[2]=m=>i.type=m),placeholder:"论文类型",clearable:"",onChange:v},{default:l(()=>[t(r,{label:"全部",value:""}),t(r,{label:"期刊论文",value:"journal"}),t(r,{label:"学会论文",value:"conference"}),t(r,{label:"学位论文",value:"degree"})]),_:1},8,["modelValue"])]),_:1}),t(o,{span:6},{default:l(()=>[t(L,{type:"primary",onClick:B,loading:b.value},{default:l(()=>[t(_,null,{default:l(()=>[t(U)]),_:1}),e[3]||(e[3]=H(" 导出报表 ",-1))]),_:1},8,["loading"])]),_:1})]),_:1})]),t(h,{gutter:16,class:"stats-cards"},{default:l(()=>[t(o,{span:6},{default:l(()=>[a("div",tt,[a("div",et,[t(_,null,{default:l(()=>[t(j)]),_:1})]),a("div",at,[a("div",st,y(d.total),1),e[4]||(e[4]=a("div",{class:"stat-label"},"论文总数",-1))])])]),_:1}),t(o,{span:6},{default:l(()=>[a("div",ot,[a("div",lt,[t(_,null,{default:l(()=>[t(A)]),_:1})]),a("div",nt,[a("div",it,y(d.highQuality),1),e[5]||(e[5]=a("div",{class:"stat-label"},"高质量论文",-1))])])]),_:1}),t(o,{span:6},{default:l(()=>[a("div",rt,[a("div",dt,[t(_,null,{default:l(()=>[t(M)]),_:1})]),a("div",ct,[a("div",pt,y(d.growth)+"%",1),e[6]||(e[6]=a("div",{class:"stat-label"},"同比增长",-1))])])]),_:1}),t(o,{span:6},{default:l(()=>[a("div",ut,[a("div",_t,[t(_,null,{default:l(()=>[t(P)]),_:1})]),a("div",mt,[a("div",ft,y(d.topRank),1),e[7]||(e[7]=a("div",{class:"stat-label"},"院内排名",-1))])])]),_:1})]),_:1}),t(h,{gutter:16},{default:l(()=>[t(o,{span:12},{default:l(()=>[a("div",vt,[e[8]||(e[8]=a("h3",null,"论文数量趋势",-1)),a("div",{ref_key:"trendChartRef",ref:c,style:{height:"400px"}},null,512)])]),_:1}),t(o,{span:12},{default:l(()=>[a("div",ht,[e[9]||(e[9]=a("h3",null,"期刊分区分布",-1)),a("div",{ref_key:"partitionChartRef",ref:p,style:{height:"400px"}},null,512)])]),_:1})]),_:1}),t(h,{gutter:16},{default:l(()=>[t(o,{span:24},{default:l(()=>[a("div",gt,[e[10]||(e[10]=a("h3",null,"部门统计对比",-1)),a("div",{ref_key:"departmentChartRef",ref:u,style:{height:"400px"}},null,512)])]),_:1})]),_:1})])}}},Ot=T(yt,[["__scopeId","data-v-1ca2c9a0"]]);export{Ot as default};
