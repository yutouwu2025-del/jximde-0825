import{_ as at}from"./_plugin-vue_export-helper-BwE83l92.js";/* empty css                   *//* empty css                 *//* empty css                        *//* empty css                    */import"./el-tooltip-l0sNRNKZ.js";/* empty css                     *//* empty css               *//* empty css               */import{u as st,r as v,y as D,o as ot,c as y,b as p,e as t,f as e,t as l,w as o,a2 as nt,v as R,a3 as lt,i as rt,G as d,a4 as it,P as ct,n as c,F as E,h as z,M as g,a5 as dt,Q as pt,J as ut,q as _t,a6 as mt,a7 as vt,s as ft,a8 as ht,S as yt,$ as gt,a0 as bt}from"./index-BxcNgWEf.js";import{p as M}from"./papers-CVFD9aL8.js";import{n as Pt}from"./notifications-iykU-k1X.js";import{i as wt}from"./index-DfyD2RhD.js";const kt={class:"dashboard-container"},Ct={class:"page-header"},St={class:"page-description"},xt={class:"stats-card primary"},Dt={class:"stats-icon"},Rt={class:"stats-content"},Et={class:"stats-number"},zt={class:"stats-trend"},Mt={class:"stats-card success"},Qt={class:"stats-icon"},Tt={class:"stats-content"},jt={class:"stats-number"},At={class:"stats-trend"},It={class:"stats-card warning"},Bt={class:"stats-icon"},Lt={class:"stats-content"},Nt={class:"stats-number"},$t={class:"stats-trend"},qt={class:"stats-card info"},Vt={class:"stats-icon"},Ft={class:"stats-content"},Ot={class:"stats-number"},Wt={class:"stats-trend"},Ut={class:"card quick-actions-card"},Gt={class:"card-title"},Ht=["onClick"],Jt={class:"action-label"},Kt={class:"card recent-papers-card"},Xt={class:"card-title"},Yt={class:"paper-title"},Zt={class:"paper-journal"},te={class:"card notifications-card"},ee={class:"card-title"},ae={class:"notification-list"},se={class:"notification-header"},oe={class:"notification-time"},ne={class:"notification-content"},le={class:"card chart-card"},re={class:"card-title"},ie={__name:"Dashboard",setup(ce){const Q=rt(),T=st(),b=v(!1),P=v(null),i=v({totalPapers:0,approvedPapers:0,pendingPapers:0,highQualityPapers:0,monthlyIncrease:0,approvalRate:0}),w=v([]),f=v([]),j=D(()=>{const a=new Date().getHours();return a<12?"早上好":a<18?"下午好":"晚上好"}),A=D(()=>{var _;const a=[{name:"submit-paper",label:"论文提交",icon:"EditPen",color:"#1890ff",path:"/submit-paper"},{name:"my-papers",label:"我的论文",icon:"Document",color:"#52c41a",path:"/my-papers"},{name:"statistics",label:"数据统计",icon:"PieChart",color:"#fa8c16",path:"/statistics"},{name:"import-export",label:"导入导出",icon:"Upload",color:"#722ed1",path:"/import-export"}],s={manager:[{name:"paper-audit",label:"论文审核",icon:"Check",color:"#f5222d",path:"/paper-audit"},{name:"paper-database",label:"论文数据库",icon:"FolderOpened",color:"#13c2c2",path:"/paper-database"}],admin:[{name:"paper-audit",label:"论文审核",icon:"Check",color:"#f5222d",path:"/paper-audit"},{name:"system-management",label:"系统管理",icon:"Setting",color:"#eb2f96",path:"/system-management"}]},h=(_=T.user)==null?void 0:_.role,r=s[h]||[];return[...a,...r]}),I=a=>{Q.push(a.path)},B=a=>({draft:"info",pending:"warning",approved:"success",rejected:"danger"})[a]||"info",L=a=>({draft:"草稿",pending:"待审核",approved:"已通过",rejected:"已拒绝"})[a]||"未知",S=a=>bt(a).format("MM-DD"),N=a=>{R.info("查看论文详情功能开发中...")},$=async()=>{b.value=!0;try{await Promise.all([q(),V(),F()])}catch(a){console.error("加载仪表板数据失败:",a),R.error("加载数据失败")}finally{b.value=!1}},q=async()=>{try{const a=await M.getPaperStats();i.value={totalPapers:a.data.total||0,approvedPapers:a.data.approved||0,pendingPapers:a.data.pending||0,highQualityPapers:a.data.highQuality||0,monthlyIncrease:a.data.monthlyIncrease||0,approvalRate:a.data.approvalRate||0}}catch(a){console.error("加载统计数据失败:",a),i.value={totalPapers:12,approvedPapers:8,pendingPapers:3,highQualityPapers:5,monthlyIncrease:2,approvalRate:75}}},V=async()=>{try{const a=await M.getMyPapers({limit:5,sort:"created_at",order:"desc"});w.value=a.data.papers||[]}catch(a){console.error("加载最近论文失败:",a),w.value=[{id:1,title:"基于深度学习的图像识别算法研究",journal:"Pattern Recognition",type:"期刊论文",status:"approved",created_at:"2024-01-15"},{id:2,title:"机器学习在自然语言处理中的应用",journal:"Computer Science",type:"期刊论文",status:"pending",created_at:"2024-01-10"},{id:3,title:"人工智能发展趋势分析",journal:"AI Research",type:"学会论文",status:"draft",created_at:"2024-01-05"}]}},F=async()=>{try{const a=await Pt.getNotifications({limit:5,sort:"created_at",order:"desc"});f.value=a.data.notifications||[]}catch(a){console.error("加载最近通知失败:",a),f.value=[{id:1,title:"系统维护通知",content:"系统将于本周日进行维护，预计维护时间2小时。",created_at:"2024-01-15"},{id:2,title:"论文审核标准更新",content:"请各位用户注意，论文审核标准已更新，请查看最新要求。",created_at:"2024-01-12"}]}},O=()=>{lt(()=>{if(!P.value)return;const a=wt(P.value),s={tooltip:{trigger:"item",formatter:"{a} <br/>{b}: {c} ({d}%)"},legend:{bottom:"0",left:"center"},series:[{name:"论文状态",type:"pie",radius:["40%","70%"],center:["50%","45%"],avoidLabelOverlap:!1,label:{show:!1,position:"center"},emphasis:{label:{show:!0,fontSize:"18",fontWeight:"bold"}},labelLine:{show:!1},data:[{value:i.value.approvedPapers,name:"已通过",itemStyle:{color:"#52c41a"}},{value:i.value.pendingPapers,name:"待审核",itemStyle:{color:"#fa8c16"}},{value:i.value.totalPapers-i.value.approvedPapers-i.value.pendingPapers,name:"草稿",itemStyle:{color:"#d9d9d9"}}]}]};a.setOption(s),window.addEventListener("resize",()=>{a.resize()})})};return ot(async()=>{await $(),O()}),(a,s)=>{const h=d("Document"),r=ct,_=d("TrendCharts"),u=it,W=d("Check"),U=d("Clock"),G=d("Warning"),H=d("Star"),k=nt,J=d("Lightning"),C=_t,m=vt,x=ft,K=mt,X=d("Bell"),Y=gt,Z=d("PieChart"),tt=ht;return p(),y("div",kt,[t("div",Ct,[s[2]||(s[2]=t("h1",{class:"page-title"},"工作台",-1)),t("p",St,"欢迎使用科研论文数据管理平台，"+l(j.value)+"！",1)]),e(k,{gutter:24,class:"stats-row"},{default:o(()=>[e(u,{xs:24,sm:12,md:6},{default:o(()=>[t("div",xt,[t("div",Dt,[e(r,{size:"32"},{default:o(()=>[e(h)]),_:1})]),t("div",Rt,[t("div",Et,l(i.value.totalPapers),1),s[3]||(s[3]=t("div",{class:"stats-label"},"我的论文总数",-1)),t("div",zt,[e(r,null,{default:o(()=>[e(_)]),_:1}),t("span",null,"本月 +"+l(i.value.monthlyIncrease),1)])])])]),_:1}),e(u,{xs:24,sm:12,md:6},{default:o(()=>[t("div",Mt,[t("div",Qt,[e(r,{size:"32"},{default:o(()=>[e(W)]),_:1})]),t("div",Tt,[t("div",jt,l(i.value.approvedPapers),1),s[4]||(s[4]=t("div",{class:"stats-label"},"已通过审核",-1)),t("div",At,[e(r,null,{default:o(()=>[e(_)]),_:1}),t("span",null,"通过率 "+l(i.value.approvalRate)+"%",1)])])])]),_:1}),e(u,{xs:24,sm:12,md:6},{default:o(()=>[t("div",It,[t("div",Bt,[e(r,{size:"32"},{default:o(()=>[e(U)]),_:1})]),t("div",Lt,[t("div",Nt,l(i.value.pendingPapers),1),s[6]||(s[6]=t("div",{class:"stats-label"},"待审核论文",-1)),t("div",$t,[e(r,null,{default:o(()=>[e(G)]),_:1}),s[5]||(s[5]=t("span",null,"需要关注",-1))])])])]),_:1}),e(u,{xs:24,sm:12,md:6},{default:o(()=>[t("div",qt,[t("div",Vt,[e(r,{size:"32"},{default:o(()=>[e(H)]),_:1})]),t("div",Ft,[t("div",Ot,l(i.value.highQualityPapers),1),s[8]||(s[8]=t("div",{class:"stats-label"},"高质量论文",-1)),t("div",Wt,[e(r,null,{default:o(()=>[e(_)]),_:1}),s[7]||(s[7]=t("span",null,"Q1/Q2区论文",-1))])])])]),_:1})]),_:1}),e(k,{gutter:24},{default:o(()=>[e(u,{xs:24,lg:16},{default:o(()=>[t("div",Ut,[t("div",Gt,[e(r,null,{default:o(()=>[e(J)]),_:1}),s[9]||(s[9]=c(" 快速操作 ",-1))]),e(k,{gutter:16,class:"quick-actions"},{default:o(()=>[(p(!0),y(E,null,z(A.value,n=>(p(),g(u,{xs:12,sm:8,md:6,key:n.name},{default:o(()=>[t("div",{class:"quick-action-item",onClick:et=>I(n)},[e(r,{class:"action-icon",style:dt({color:n.color})},{default:o(()=>[(p(),g(pt(n.icon)))]),_:2},1032,["style"]),t("span",Jt,l(n.label),1)],8,Ht)]),_:2},1024))),128))]),_:1})]),t("div",Kt,[t("div",Xt,[e(r,null,{default:o(()=>[e(h)]),_:1}),s[11]||(s[11]=c(" 最近论文 ",-1)),e(C,{text:"",type:"primary",class:"view-more",onClick:s[0]||(s[0]=n=>a.$router.push("/my-papers"))},{default:o(()=>[...s[10]||(s[10]=[c(" 查看更多 ",-1)])]),_:1})]),ut((p(),g(K,{data:w.value,style:{width:"100%"}},{default:o(()=>[e(m,{prop:"title",label:"论文标题","min-width":"200"},{default:o(({row:n})=>[t("div",Yt,l(n.title),1),t("div",Zt,l(n.journal),1)]),_:1}),e(m,{prop:"type",label:"类型",width:"100"},{default:o(({row:n})=>[e(x,{size:"small"},{default:o(()=>[c(l(n.type),1)]),_:2},1024)]),_:1}),e(m,{prop:"status",label:"状态",width:"100"},{default:o(({row:n})=>[e(x,{type:B(n.status),size:"small"},{default:o(()=>[c(l(L(n.status)),1)]),_:2},1032,["type"])]),_:1}),e(m,{prop:"created_at",label:"提交时间",width:"120"},{default:o(({row:n})=>[c(l(S(n.created_at)),1)]),_:1}),e(m,{label:"操作",width:"100"},{default:o(({row:n})=>[e(C,{text:"",type:"primary",size:"small",onClick:et=>N(n)},{default:o(()=>[...s[12]||(s[12]=[c(" 查看 ",-1)])]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[tt,b.value]])])]),_:1}),e(u,{xs:24,lg:8},{default:o(()=>[t("div",te,[t("div",ee,[e(r,null,{default:o(()=>[e(X)]),_:1}),s[14]||(s[14]=c(" 通知公告 ",-1)),e(C,{text:"",type:"primary",class:"view-more",onClick:s[1]||(s[1]=n=>a.$router.push("/notifications"))},{default:o(()=>[...s[13]||(s[13]=[c(" 查看更多 ",-1)])]),_:1})]),t("div",ae,[(p(!0),y(E,null,z(f.value,n=>(p(),y("div",{key:n.id,class:"notification-item"},[t("div",se,[t("h4",null,l(n.title),1),t("span",oe,l(S(n.created_at)),1)]),t("p",ne,l(n.content),1)]))),128)),f.value.length===0?(p(),g(Y,{key:0,description:"暂无通知"})):yt("",!0)])]),t("div",le,[t("div",re,[e(r,null,{default:o(()=>[e(Z)]),_:1}),s[15]||(s[15]=c(" 论文状态分布 ",-1))]),t("div",{ref_key:"chartRef",ref:P,style:{height:"300px"}},null,512)])]),_:1})]),_:1})])}}},ke=at(ie,[["__scopeId","data-v-82b260ca"]]);export{ke as default};
