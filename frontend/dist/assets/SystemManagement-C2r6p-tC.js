import{_ as oe}from"./_plugin-vue_export-helper-BwE83l92.js";/* empty css                  *//* empty css                   *//* empty css               *//* empty css                  *//* empty css                     *//* empty css               *//* empty css                     *//* empty css                 *//* empty css                        *//* empty css                        *//* empty css                    */import"./el-tooltip-l0sNRNKZ.js";import{x as u,r as b,a as P,o as ne,c as z,b as D,e as l,f as t,w as a,ar as re,I as ue,G as de,as as ie,q as me,n as d,P as pe,a6 as ce,a7 as _e,s as fe,t as y,E as ve,j as ge,k as be,af as ye,at as Ve,a2 as Ue,a4 as we,M as O,S as ke,ab as Ee,ac as xe,F as Ce,h as De,a1 as Se,v as p}from"./index-BxcNgWEf.js";const U={getUsers(n={}){return u.get("/users",{params:n})},createUser(n){return u.post("/users",n)},updateUser(n,i){return u.put(`/users/${n}`,i)},deleteUser(n){return u.delete(`/users/${n}`)},getUserDetail(n){return u.get(`/users/${n}`)},resetUserPassword(n,i){return u.post(`/users/${n}/reset-password`,{password:i})},toggleUserStatus(n,i){return u.post(`/users/${n}/toggle-status`,{status:i})},batchOperateUsers(n,i){return u.post("/users/batch",{userIds:n,operation:i})},getRoles(){return u.get("/users/roles")},getDepartments(){return u.get("/users/departments")},createDepartment(n){return u.post("/users/departments",n)},updateDepartment(n,i){return u.put(`/users/departments/${n}`,i)},deleteDepartment(n){return u.delete(`/users/departments/${n}`)}},$e={class:"system-management-container"},Ne={class:"tab-content"},Te={class:"section-header"},Pe={class:"tab-content"},Be={class:"section-header"},Fe={class:"tab-content"},Me={class:"tab-content"},Re={class:"monitor-card"},Ie={class:"monitor-value"},Le={class:"monitor-card"},qe={class:"monitor-value"},ze={class:"monitor-card"},Oe={class:"monitor-value"},je={class:"monitor-card"},Ae={class:"monitor-value"},Ge={__name:"SystemManagement",setup(n){const i=b("users"),g=b(!1),v=b(null),B=b(null),S=b([]),w=b([]),r=P({username:"",name:"",role:"user",department:"",password:""}),j={username:[{required:!0,message:"请输入用户名",trigger:"blur"}],name:[{required:!0,message:"请输入姓名",trigger:"blur"}],role:[{required:!0,message:"请选择角色",trigger:"change"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}]},f=P({systemName:"科研论文数据管理平台",fileUploadLimit:50,auditPeriod:7,emailNotification:!0}),$=P({onlineUsers:24,todayVisits:156,storageUsage:68,systemStatus:"normal"}),A=o=>({user:"info",manager:"success",secretary:"warning",admin:"danger"})[o]||"info",G=o=>({user:"普通用户",manager:"论文管理员",secretary:"课题组秘书",admin:"系统管理员"})[o]||"未知",H=()=>{v.value=null,Object.assign(r,{username:"",name:"",role:"user",department:"",password:""}),g.value=!0},J=o=>{v.value=o,Object.assign(r,{username:o.username,name:o.name,role:o.role,department:o.department,password:""}),g.value=!0},K=async()=>{try{if(!await B.value.validate())return;v.value?(await U.updateUser(v.value.id,r),p.success("用户更新成功")):(await U.createUser(r),p.success("用户创建成功")),g.value=!1,N()}catch{p.error("操作失败")}},Q=async o=>{try{await Se.prompt("请输入新密码","重置密码",{inputType:"password"}),p.success("密码重置成功")}catch(e){e!=="cancel"&&p.error("密码重置失败")}},W=async o=>{try{const e=o.status==="active"?"inactive":"active";await U.toggleUserStatus(o.id,e),p.success("状态更新成功"),N()}catch{p.error("状态更新失败")}},X=()=>{p.info("添加部门功能开发中...")},Y=o=>{p.info("编辑部门功能开发中...")},Z=o=>{p.info("删除部门功能开发中...")},h=()=>{p.success("配置保存成功")},N=async()=>{try{const o=await U.getUsers();S.value=o.data.users||[]}catch{S.value=[{id:1,username:"admin",name:"系统管理员",role:"admin",department:"管理部门",status:"active",last_login:"2024-01-15 10:30"}]}},ee=async()=>{try{const o=await U.getDepartments();w.value=o.data.departments||[]}catch{w.value=[{id:1,name:"计算机部",description:"计算机科学研究",user_count:15,created_at:"2024-01-01"},{id:2,name:"人工智能部",description:"人工智能研究",user_count:12,created_at:"2024-01-01"}]}};return ne(()=>{N(),ee()}),(o,e)=>{const F=de("Plus"),M=pe,c=me,m=_e,T=fe,R=ce,k=ie,E=be,_=ge,I=ye,te=Ve,L=ve,x=we,ae=Ue,se=re,V=xe,q=Ee,le=ue;return D(),z("div",$e,[e[32]||(e[32]=l("div",{class:"page-header"},[l("h1",{class:"page-title"},"系统管理"),l("p",{class:"page-description"},"管理用户权限、系统配置和维护系统正常运行")],-1)),t(se,{modelValue:i.value,"onUpdate:modelValue":e[4]||(e[4]=s=>i.value=s),class:"management-tabs"},{default:a(()=>[t(k,{label:"用户管理",name:"users"},{default:a(()=>[l("div",Ne,[l("div",Te,[e[13]||(e[13]=l("h3",null,"用户管理",-1)),t(c,{type:"primary",onClick:H},{default:a(()=>[t(M,null,{default:a(()=>[t(F)]),_:1}),e[12]||(e[12]=d(" 添加用户 ",-1))]),_:1})]),t(R,{data:S.value,stripe:""},{default:a(()=>[t(m,{prop:"username",label:"用户名"}),t(m,{prop:"name",label:"姓名"}),t(m,{prop:"role",label:"角色"},{default:a(({row:s})=>[t(T,{type:A(s.role)},{default:a(()=>[d(y(G(s.role)),1)]),_:2},1032,["type"])]),_:1}),t(m,{prop:"department",label:"部门"}),t(m,{prop:"status",label:"状态"},{default:a(({row:s})=>[t(T,{type:s.status==="active"?"success":"danger"},{default:a(()=>[d(y(s.status==="active"?"正常":"禁用"),1)]),_:2},1032,["type"])]),_:1}),t(m,{prop:"last_login",label:"最后登录"}),t(m,{label:"操作",width:"200"},{default:a(({row:s})=>[t(c,{text:"",type:"primary",size:"small",onClick:C=>J(s)},{default:a(()=>[...e[14]||(e[14]=[d(" 编辑 ",-1)])]),_:2},1032,["onClick"]),t(c,{text:"",type:"warning",size:"small",onClick:C=>Q(s)},{default:a(()=>[...e[15]||(e[15]=[d(" 重置密码 ",-1)])]),_:2},1032,["onClick"]),t(c,{text:"",type:"danger",size:"small",onClick:C=>W(s)},{default:a(()=>[d(y(s.status==="active"?"禁用":"启用"),1)]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])])]),_:1}),t(k,{label:"部门管理",name:"departments"},{default:a(()=>[l("div",Pe,[l("div",Be,[e[17]||(e[17]=l("h3",null,"部门管理",-1)),t(c,{type:"primary",onClick:X},{default:a(()=>[t(M,null,{default:a(()=>[t(F)]),_:1}),e[16]||(e[16]=d(" 添加部门 ",-1))]),_:1})]),t(R,{data:w.value,stripe:""},{default:a(()=>[t(m,{prop:"name",label:"部门名称"}),t(m,{prop:"description",label:"部门描述"}),t(m,{prop:"user_count",label:"用户数量"}),t(m,{prop:"created_at",label:"创建时间"}),t(m,{label:"操作",width:"150"},{default:a(({row:s})=>[t(c,{text:"",type:"primary",size:"small",onClick:C=>Y(s)},{default:a(()=>[...e[18]||(e[18]=[d(" 编辑 ",-1)])]),_:2},1032,["onClick"]),t(c,{text:"",type:"danger",size:"small",onClick:C=>Z(s)},{default:a(()=>[...e[19]||(e[19]=[d(" 删除 ",-1)])]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])])]),_:1}),t(k,{label:"系统配置",name:"settings"},{default:a(()=>[l("div",Fe,[e[23]||(e[23]=l("h3",null,"系统配置",-1)),t(L,{model:f,"label-width":"150px"},{default:a(()=>[t(_,{label:"系统名称"},{default:a(()=>[t(E,{modelValue:f.systemName,"onUpdate:modelValue":e[0]||(e[0]=s=>f.systemName=s)},null,8,["modelValue"])]),_:1}),t(_,{label:"文件上传限制"},{default:a(()=>[t(I,{modelValue:f.fileUploadLimit,"onUpdate:modelValue":e[1]||(e[1]=s=>f.fileUploadLimit=s),min:1,max:100},null,8,["modelValue"]),e[20]||(e[20]=l("span",{style:{"margin-left":"8px"}},"MB",-1))]),_:1}),t(_,{label:"论文审核周期"},{default:a(()=>[t(I,{modelValue:f.auditPeriod,"onUpdate:modelValue":e[2]||(e[2]=s=>f.auditPeriod=s),min:1,max:30},null,8,["modelValue"]),e[21]||(e[21]=l("span",{style:{"margin-left":"8px"}},"天",-1))]),_:1}),t(_,{label:"邮件通知"},{default:a(()=>[t(te,{modelValue:f.emailNotification,"onUpdate:modelValue":e[3]||(e[3]=s=>f.emailNotification=s)},null,8,["modelValue"])]),_:1}),t(_,null,{default:a(()=>[t(c,{type:"primary",onClick:h},{default:a(()=>[...e[22]||(e[22]=[d("保存配置",-1)])]),_:1})]),_:1})]),_:1},8,["model"])])]),_:1}),t(k,{label:"系统监控",name:"monitor"},{default:a(()=>[l("div",Me,[e[29]||(e[29]=l("h3",null,"系统监控",-1)),t(ae,{gutter:16,class:"monitor-cards"},{default:a(()=>[t(x,{span:6},{default:a(()=>[l("div",Re,[e[24]||(e[24]=l("div",{class:"monitor-title"},"在线用户",-1)),l("div",Ie,y($.onlineUsers),1)])]),_:1}),t(x,{span:6},{default:a(()=>[l("div",Le,[e[25]||(e[25]=l("div",{class:"monitor-title"},"今日访问",-1)),l("div",qe,y($.todayVisits),1)])]),_:1}),t(x,{span:6},{default:a(()=>[l("div",ze,[e[26]||(e[26]=l("div",{class:"monitor-title"},"存储使用",-1)),l("div",Oe,y($.storageUsage)+"%",1)])]),_:1}),t(x,{span:6},{default:a(()=>[l("div",je,[e[28]||(e[28]=l("div",{class:"monitor-title"},"系统状态",-1)),l("div",Ae,[t(T,{type:"success"},{default:a(()=>[...e[27]||(e[27]=[d("正常",-1)])]),_:1})])])]),_:1})]),_:1})])]),_:1})]),_:1},8,["modelValue"]),t(le,{modelValue:g.value,"onUpdate:modelValue":e[11]||(e[11]=s=>g.value=s),title:v.value?"编辑用户":"添加用户",width:"500px"},{footer:a(()=>[t(c,{onClick:e[10]||(e[10]=s=>g.value=!1)},{default:a(()=>[...e[30]||(e[30]=[d("取消",-1)])]),_:1}),t(c,{type:"primary",onClick:K},{default:a(()=>[...e[31]||(e[31]=[d("确定",-1)])]),_:1})]),default:a(()=>[t(L,{ref_key:"userFormRef",ref:B,model:r,rules:j,"label-width":"100px"},{default:a(()=>[t(_,{label:"用户名",prop:"username"},{default:a(()=>[t(E,{modelValue:r.username,"onUpdate:modelValue":e[5]||(e[5]=s=>r.username=s),disabled:!!v.value},null,8,["modelValue","disabled"])]),_:1}),t(_,{label:"姓名",prop:"name"},{default:a(()=>[t(E,{modelValue:r.name,"onUpdate:modelValue":e[6]||(e[6]=s=>r.name=s)},null,8,["modelValue"])]),_:1}),t(_,{label:"角色",prop:"role"},{default:a(()=>[t(q,{modelValue:r.role,"onUpdate:modelValue":e[7]||(e[7]=s=>r.role=s)},{default:a(()=>[t(V,{label:"普通用户",value:"user"}),t(V,{label:"论文管理员",value:"manager"}),t(V,{label:"课题组秘书",value:"secretary"}),t(V,{label:"系统管理员",value:"admin"})]),_:1},8,["modelValue"])]),_:1}),t(_,{label:"部门",prop:"department"},{default:a(()=>[t(q,{modelValue:r.department,"onUpdate:modelValue":e[8]||(e[8]=s=>r.department=s)},{default:a(()=>[(D(!0),z(Ce,null,De(w.value,s=>(D(),O(V,{key:s.id,label:s.name,value:s.name},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),v.value?ke("",!0):(D(),O(_,{key:0,label:"密码",prop:"password"},{default:a(()=>[t(E,{modelValue:r.password,"onUpdate:modelValue":e[9]||(e[9]=s=>r.password=s),type:"password"},null,8,["modelValue"])]),_:1}))]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}},ot=oe(Ge,[["__scopeId","data-v-ce2eb303"]]);export{ot as default};
